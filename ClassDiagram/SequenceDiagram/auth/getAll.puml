@startuml Get All (GET)

header Massage Reservation Sequence Diagram: Get All
footer CEDT Chulalongkorn University
title "Get All (GET)"

participant "User" as user
participant "<<javaScript>>\n:server" as server
participant "<<router>>\n:auth" as routerAuths
participant "<<middleware>>\n:protect" as protect
participant "<<middleware>>\n:authorize" as authorize
participant "<<controllers>>\n:auth" as controllersAuths
participant "<<model>>\n:User" as modelUser
database "<<MongoDB>>\n:user" as AuthsDatabase

user->server ++:req.post('/api/v1/auth/all')
server->routerAuths ++:app.use('/api/v1/auth',auth)
routerAuths -> protect ++:verifyToken()
protect --> routerAuths --:req.user()
routerAuths -> authorize ++:authorize('admin')
authorize --> routerAuths --:authorized

routerAuths -> controllersAuths ++:getAll()
controllersAuths->modelUser ++:find()
modelUser ->AuthsDatabase ++: UserSchema
AuthsDatabase --> modelUser --: user
controllersAuths <-- modelUser --:user
controllersAuths->user --:response, token

@enduml
